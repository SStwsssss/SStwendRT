<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>SStwendRT Encrypt</title></head>
<body>
<textarea id="in" rows="3" placeholder='print("OK")'></textarea>
<button onclick="run()">Encrypt</button>
<br><textarea id="out" rows="6" readonly></textarea>

<script>
function b64enc(s) {
  return btoa(s).replace(/=+$/, '');
}
function xorRev(s, k) {
  let r = '';
  for (let i = 0; i < s.length; i++) {
    r += String.fromCharCode(s.charCodeAt(i) ^ k.charCodeAt(i % k.length));
  }
  return r.split('').reverse().join('');
}
function run() {
  const src = document.getElementById('in').value;
  const key = 'SStwendRT';
  const enc = b64enc(xorRev(src, key));
  
  const loader = 
    `(function()local s,k="${enc}","${key}"`+
    `local b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"`+
    `local d=""for i=1,#s,4 do`+
      `local t=0 for j=0,3 do local c=s:sub(i+j,i+j)local v=c==""and 0or b:find(c,1,1)-1 t=t*64+v end`+
      `d=d..string.char(bit32.band(t//65536,255))..string.char(bit32.band(t//256,255))..string.char(bit32.band(t,255))`+
    `end`+
    `d=d:sub(1,-(#s%4==2 and 2 or #s%4==3 and 1 or 0))`+
    `local r=""for i=#d,1,-1 do r=r..d:sub(i,i)end`+
    `local c=""for i=1,#r do c=c..string.char(bit32.bxor(r:byte(i),k:byte((i-1)%#k+1)))end`+
    `return loadstring(c)end)()`;
  
  document.getElementById('out').value = loader;
}
run();
</script>
</body>
</html>
