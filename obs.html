<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Roblox –û–Ω–ª–∞–π–Ω</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f5f5f5; }
    .input { margin: 10px 0; }
    .server { background: white; padding: 16px; margin: 10px 0; border-radius: 6px; box-shadow: 0 1px 4px #ccc; }
    .online { font-size: 24px; color: #2e7d32; font-weight: bold; }
  </style>
</head>
<body>

<h2>üéÆ –û–Ω–ª–∞–π–Ω –ø–æ Place ID</h2>
<div class="input">
  <input type="text" id="placeId" placeholder="–í–≤–µ–¥–∏—Ç–µ Place ID (–Ω–∞–ø—Ä. 286090429)" />
  <button onclick="checkOnline()">–ü–æ–∫–∞–∑–∞—Ç—å –æ–Ω–ª–∞–π–Ω</button>
</div>

<div id="result"></div>

<script>
async function checkOnline() {
  const placeId = document.getElementById('placeId').value.trim();
  if (!placeId || isNaN(placeId)) {
    alert('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!');
    return;
  }

  const resultDiv = document.getElementById('result');
  resultDiv.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>';

  try {
    // ‚úÖ –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä—ã
    const url = `https://www.roblox.com/games/${placeId}/_`;
    const response = await fetch(url);
    const html = await response.text();

    // üîç –ò—â–µ–º —Å–∫—Ä–∏–ø—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–≥—Ä—ã
    const match = html.match(/Roblox\.GameLaunch\.resize\(\s*{[\s\S]*?universeId:\s*(\d+)[\s\S]*?name:\s*["']([^"']+)["'][\s\S]*?playing:\s*(\d+)/i);

    if (!match) {
      // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ ‚Äî —á–µ—Ä–µ–∑ JSON –≤ <script type="application/json">
      const jsonMatch = html.match(/<script type="application\/json" id="game-details">([\s\S]*?)<\/script>/i);
      if (jsonMatch) {
        try {
          const data = JSON.parse(jsonMatch[1]);
          const { name, universeId } = data;
          const playingMatch = html.match(/"playingCount":(\d+)/);
          const playing = playingMatch ? parseInt(playingMatch[1]) : 0;
          showResult(placeId, name, playing);
          return;
        } catch (e) {
          throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON');
        }
      }
      throw new Error('–î–∞–Ω–Ω—ã–µ –æ–± –æ–Ω–ª–∞–π–Ω–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ');
    }

    const universeId = match[1];
    const name = match[2].replace(/\\'/g, "'");
    const playing = parseInt(match[3]);

    showResult(placeId, name, playing);
  } catch (err) {
    console.error(err);
    resultDiv.innerHTML = `<p style="color:red">‚ùå –û—à–∏–±–∫–∞: ${err.message}</p>`;
  }
}

function showResult(placeId, name, playing) {
  const resultDiv = document.getElementById('result');
  resultDiv.innerHTML = `
    <div class="server">
      <h3>${escapeHtml(name)}</h3>
      <p><strong>Place ID:</strong> ${placeId}</p>
      <p class="online">üéÆ –û–Ω–ª–∞–π–Ω: ${playing}</p>
    </div>
  `;
}

function escapeHtml(str) {
  return String(str).replace(/[&<>"']/g, m => ({
    '&': '&amp;',
    '<': '<',
    '>': '>',
    '"': '&quot;',
    "'": '&#039;'
  })[m]);
}
</script>

</body>
</html>
